<div class="container">

  <form [formGroup]="companyForm">
    <div class="row">

      <!-- header -->
      <div class="col s12 center-align padding">
        <h5 class="no-margin">Associar serviço</h5>
      </div>

      <!-- message -->
      <div class="col s12">
        <p class="center-align no-margin">Escolha a agência e o tipo de serviço prestado pela empresas.</p>
      </div>

      <!-- agency -->
      <div class="row margin-top">
        <div class="col s12 padding-horizontal padding-top">
          <div class="input-field" *ngIf="agencies$">
            <select id="category" materialize="material_select" formControlName="agency_id">
              <option value="" disabled selected>Selecione a agência</option>
              <option *ngFor="let agency of agencies$ | async" [value]="agency.agency_id">{{agency.agency_code + ' - '
                +
                agency.agency_name}}</option>
            </select>
            <label for="category">Agência</label>
          </div>
        </div>
      </div>

      <!-- loading -->
      <div class="row" *ngIf="loading">
        <app-item-loading></app-item-loading>
      </div>

      <!-- labels -->
      <div class="row" *ngIf="services$ && (services$ | async)?.length > 0 && !loading">
        <div class="col padding-horizontal">
          <p>
            <input onclick="return false;" type="checkbox" id="label1" checked />
            <label for="label1">
              Serviço associado
            </label>
          </p>
        </div>
        <div class="col">
          <p>
            <input onclick="return false;" type="checkbox" id="label2" disabled="true" />
            <label for="label2">
              Serviço associado a outra empresa
            </label>
          </p>
        </div>
        <div class="col">
          <p>
            <input onclick="return false;" type="checkbox" id="label3" />
            <label for="label3">
              Serviço não associado
            </label>
          </p>
        </div>
      </div>

      <!-- services list -->
      <div class="row margin-top" *ngIf="services$ && (services$ | async)?.length > 0 && !loading">
        <div class="col s12 m6 l4 padding-horizontal" *ngFor="let service of services$ | async">
          <p>
            <input type="checkbox" [id]="service.service_type_id" [checked]="(service?.checked && service?.checked === '1') ? true : false"
              [disabled]="(service?.company_id && service?.company_id !== company_id) ? true : false" 
              (change)="onCheckboxValueChange($event, companyForm.getRawValue().agency_id, service?.service_type_id, company_id)" />
            <label [for]="service.service_type_id">
              {{ service.service_type_description }}
              <span *ngIf="service?.company_id && service?.company_id !== company_id"> 
                ({{ service?.company_fantasy_name }}) </span>
            </label>
          </p>
        </div>
      </div>

      <!-- button concluir -->
      <div class="col s12 m6 push-m6 center-align no-padding" *ngIf="services$ && (services$ | async)?.length > 0 && !loading">
        <app-button-generic class="button-margin-left" [text]="'Salvar'" (onClick)="saveServiceType(objectsToSave)"></app-button-generic>
      </div>

      <!-- button cancel -->
      <div class="col s12 m6 pull-m6 center-align no-padding button-margin-top" *ngIf="services$ && (services$ | async)?.length > 0 && !loading">
        <app-button-generic class="button-margin-right" [text]="'Cancelar'" [isOutline]="true" (onClick)="backPage()"></app-button-generic>
      </div>

    </div>
  </form>

</div>


<!-- message -->
<app-sweet-message [swalOptions]="swalOptions"></app-sweet-message>